# 项目：平方反比引力场中的运动 - 实验报告

**学生姓名：** [王梦]
**学号：** [20231050193]
**完成日期：** [6.4]

1. 实验目的
通过数值模拟研究不同能量（椭圆、抛物线、双曲线轨道）和角动量条件下质点在平方反比引力场中的轨道特性，验证能量守恒与角动量守恒，并分析轨道形状与能量、角动量的关系。
2. 核心算法与实现
2.1 运动方程与数值方法
•运动方程：直角坐标系下的二阶微分方程组，描述质点在平方反比引力场中的加速度：[
\frac{dx}{dt} = v_x, \quad \frac{dy}{dt} = v_y, \quad \frac{dv_x}{dt} = -\frac{GMx}{r^3}, \quad \frac{dv_y}{dt} = -\frac{GMy}{r^3} \quad (r = \sqrt{x^2 + y^2})
]
•数值方法：使用 scipy.integrate.solve_ivp，采用 RK45 算法（5(4) 阶显式龙格-库塔法），相对容差 rtol=1e-7，绝对容差 atol=1e-9。
2.2 关键函数实现思路
derivatives 函数
•功能：计算状态向量 [x, y, vx, vy] 的导数（速度与加速度）。
•关键步骤：

x, y, vx, vy = state_vector
r_cubed = (x**2 + y**2)**1.5
if r_cubed < 1e-12:
    ax = -gm_val * x / (1e-12) if x != 0 else 0
    ay = -gm_val * y / (1e-12) if y != 0 else 0
else:
    ax = -gm_val * x / r_cubed
    ay = -gm_val * y / r_cubed
return [vx, vy, ax, ay]
a.计算距离 r 的立方 r_cubed = (x² + y²)^1.5；
b.处理 r 过小时的除零问题（设置阈值 1e-12，避免数值错误）；
c.根据运动方程返回导数数组 [vx, vy, ax, ay]，其中加速度项包含引力的平方反比关系。
solve_orbit 函数
•功能：调用 solve_ivp 求解轨道微分方程。
•关键步骤：

sol = solve_ivp(
    fun=derivatives, 
    t_span=t_span, 
    y0=initial_conditions, 
    t_eval=t_eval, 
    args=(gm_val,),
    method='RK45', rtol=1e-7, atol=1e-9
)
return sol
d.传入初始条件、时间区间 t_span、时间采样点 t_eval 和参数 gm_val；
e.设置求解方法为 'RK45'，并配置容差参数。
3. 实验结果与分析
3.1 不同总能量下的轨道
图1：不同能量下的轨道图 (E<0, E=0, E>0)
![image](https://github.com/user-attachments/assets/c995c792-d744-4f25-91b3-cafb79a7e2f9)

•椭圆轨道 (E=-0.100)：闭合曲线，中心天体位于原点，轨道呈椭圆形（如 ic_ellipse = [1, 0, 0, 0.8]）。
•抛物线轨道 (E=0.000)：开口远离原点的抛物线（ic_parabola = [1, 0, 0, √2]）。
•双曲线轨道 (E=0.200)：开口更大的双曲线，质点最终远离中心天体（ic_hyperbola = [1, 0, 0, 1.2√2]）。
结果分析：
•能量与轨道类型关系：
◦E < 0：束缚轨道（椭圆），质点绕中心天体周期性运动；
◦E = 0：临界非束缚轨道（抛物线），质点渐近远离；
◦E > 0：非束缚轨道（双曲线），质点以双曲线轨迹逃逸。
能量与角动量守恒验证：
•椭圆轨道中，初始与最终能量、角动量几乎一致（如 E_ellipse[0] ≈ E_ellipse[-1]，Lz_ellipse[0] ≈ Lz_ellipse[-1]），验证守恒性；
•数值误差导致微小差异（如 1e-9 量级），来自积分过程的截断误差。
3.2 不同角动量下的椭圆轨道 (E < 0)
图2：固定能量 (E=-0.2)，不同角动量下的椭圆轨道
![image](https://github.com/user-attachments/assets/ee8c7879-400d-45db-841c-72c06282cff7)

•Launch Angle 90° (Lz=1.500)：圆形轨道（速度方向垂直于初始位置矢量，偏心率接近 0）。
•Launch Angle 60° (Lz=1.299)：椭圆轨道，偏心率增大，轨道“扁平”程度增加。
•Launch Angle 45° (Lz=1.061)：椭圆更扁，长轴变长，短轴变短。
结果分析：
•角动量影响：
◦角动量越大，轨道偏心率越小（更接近圆形）；
◦角动量越小，偏心率越大（轨道越“扁”），长轴长度与角动量成正相关。
◦固定能量时，角动量决定轨道形状，而能量决定轨道是否束缚。
4. 问题与收获
4.1 遇到的主要问题及解决方法
问题1：初始条件设置导致轨道碰撞中心天体（r=0），引发除零错误。解决方法：在 derivatives 函数中添加阈值判断（r_cubed < 1e-12），用极小值替代零分母，避免程序崩溃。
问题2：不同角动量轨道的能量一致性验证。解决方法：通过固定速度大小、改变速度方向（如 launch_angles），确保能量近似恒定，仅角动量变化。
4.2 主要收获与体会
•理解平方反比引力场中能量和角动量对轨道形状的决定性作用；
•掌握数值求解常微分方程（ODE）的方法（如 solve_ivp 的参数配置）；
•学会通过可视化（Matplotlib）分析物理现象，验证守恒定律，并理解数值误差的来源与控制。
5. (可选) 思考与展望
5.1 坐标转换与对称性
•极坐标（r, θ）可简化运动方程（如利用角动量守恒消去 θ），但直角坐标系更便于数值积分实现；
•轨道对称性：初始条件关于 x 轴对称时，轨道保持对称，反映引力场的球对称性。
5.2 模型局限性与改进
•局限性：未考虑相对论效应、多体相互作用及中心天体质量变化；
改进方向：引入极坐标方程、添加能量/角动量实时监测曲线，或扩展至三维轨道模拟。

