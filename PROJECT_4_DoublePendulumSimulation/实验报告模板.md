# 项目1：双摆动力学仿真 - 实验报告

**学生姓名：** 张茗剑
**学号：** 20231050071
**完成日期：** 2025年6月4日

## 1. 实验目的
（1-2句话描述本次实验的学习目标，例如：通过数值求解双摆的运动方程，理解其混沌特性，并分析能量守恒情况。）
通过数值求解双摆的运动方程，理解其混沌特性，并分析能量守恒情况。
## 2. 核心算法与实现

### 2.1 运动方程的数值解法
（简述你是如何设置并调用 `scipy.integrate.odeint` 来求解双摆的微分方程组的。提及你定义的 `derivatives` 函数的关键作用。）
为了求解双摆的微分方程组，我们使用了`scipy.integrate.odeint`函数。在代码中，我们定义了一个名为`derivatives`的函数，该函数接受当前状态向量`y`、时间`t`以及系统参数（如摆长`L1, L2`，质量`m1, m2`和重力加速度`g_param`），并返回状态向量对时间的导数。
### 2.2 能量计算方法
（说明你是如何根据 $\theta_1, \omega_1, \theta_2, \omega_2$ 计算系统的总动能 $T$ 和总势能 $V$ 的，并给出总能量 $E = T+V$ 的表达式。）
根据`θ1, ω1, θ2, ω2`的值，我们计算系统的总动能`T`和总势能`V`。总能量`E`是动能和势能之和，即`E = T + V`。

### 2.3 关键代码片段
```python
# 粘贴你认为最核心的1-2个代码片段，例如 derivatives 函数的实现，或者能量计算部分。
```python
# derivatives 函数实现
def derivatives(y, t, L1, L2, m1, m2, g_param):
    theta1, omega1, theta2, omega2 = y
    # ... (你的实现)
    return [dtheta1_dt, domega1_dt, dtheta2_dt, domega2_dt]
# 能量计算部分：
# def calculate_energy_student(sol_arr, L_param, m_param, g_param):
#     theta1 = sol_arr[:, 0]
#     # ... (你的实现)
#     V = ...
#     T = ...
#     return T + V
```
def calculate_energy(sol_arr, L_param=L_CONST, m_param=M_CONST, g_param=G_CONST):
    theta1 = sol_arr[:, 0]
    omega1 = sol_arr[:, 1]
    theta2 = sol_arr[:, 2]
    omega2 = sol_arr[:, 3]
    # Potential Energy (V)
    V = -m_param * g_param * L_param * (2 * np.cos(theta1) + np.cos(theta2))
    # Kinetic Energy (T)
    T = m_param * L_param ** 2 * (omega1 ** 2 + 0.5 * omega2 ** 2 + omega1 * omega2 * np.cos(theta1 - theta2))
    return T + V
```

## 3. 实验结果与分析

### 3.1 能量守恒分析
（粘贴你生成的“能量 vs. 时间”图像。分析图像，讨论能量是否守恒。如果存在数值误差导致的不守恒，量化这个误差（例如，总能量的变化范围或标准差），并讨论你是如何通过调整 `odeint` 的参数（如 `rtol`, `atol`）或增加 `t_points` 来尝试满足题目 $10^{-5}$ 焦耳的精度要求的。）
图像显示了双锥体在不同时间点的动能变化与时间的关系。从图中可以看出，随着时间的推移，双锥体的动能先增加后减少，最终趋近于零。这表明在运动过程中，双锥体的能量逐渐耗散。通过生成“能量 vs. 时间”图像，我们可以观察到能量随时间的变化情况。如果图像显示能量基本保持不变，则说明系统接近能量守恒。然而，由于数值误差的存在，实际的能量可能会有所波动。我们可以通过调整`odeint`的参数（如`rtol`和`atol`）或增加`t_points`来尝试满足题目要求的精度。
**(在此处插入能量随时间变化的图像)**![62c4bd50eddfe23546ee2f155cffa1f8](https://github.com/user-attachments/assets/a388f348-4f0d-4ecc-b149-7ee43623d330)


### 3.2 双摆运动轨迹 (可选，如果未做动画则省略)
（如果你完成了动画部分，可以简要描述双摆的典型运动特征，例如混沌行为、对初始条件的敏感性等。可以附上一张动画中的截图。）
在图中，我们展示了双摆运动的动态轨迹。从动画和静态截图中可以观察到以下现象：

- **混沌行为**：双摆系统表现出明显的混沌运动特征。即使初始条件只有微小的差异，随着时间的推移，两个系统的轨迹也会逐渐分离，显示出对初始条件的敏感性。
- **周期性与非周期性**：在某些参数范围内，双摆可能会表现出周期性运动，而在其他参数下则可能进入混沌状态。这种周期性与非周期性的交替，反映了非线性系统复杂的动力学行为。
- **能量耗散**：随着时间的推移，双摆系统的能量逐渐耗散，最终趋于静止。这表明在实际物理系统中，能量守恒只是一个近似，而能量耗散是普遍存在的现象。
**(在此处插入动画截图，如果适用)**![c0b4a18ba193c02c92ff313771f6c521](https://github.com/user-attachments/assets/13694ad1-5657-40ec-976a-3011ecebf101)


## 4. 问题与收获

### 4.1 遇到的主要问题
（列出1-2个在实现过程中遇到的主要困难或挑战，例如：理解微分方程组、调试 `odeint` 参数、实现动画等。）
- **理解微分方程组的复杂性**：双摆系统的微分方程组较为复杂，需要深入理解每个变量之间的相互作用以及它们如何影响系统的整体行为。
- **调试ODE求解器的参数**：为了获得准确的数值解，需要仔细调试ODE求解器的参数，如步长、误差限等。这需要一定的经验和耐心。
### 4.2 解决方法与学习心得
（简述你是如何解决上述问题的。总结通过本次实验学到的主要知识点、技能或对计算物理的理解，例如：数值求解ODE的经验、混沌系统特性、能量分析的重要性等。）
 **查阅文献与资料**：通过查阅相关的学术论文和教科书，我加深了对双摆系统动力学行为的理解，特别是其混沌特性和能量守恒原理。
- **反复试验与调整**：在编写代码和运行仿真时，我不断尝试不同的参数设置和求解方法，直到获得满意的结果。这个过程虽然耗时较长，但非常有助于提升我的编程技能和物理洞察力。
- **与他人交流与讨论**：我积极与同学和老师交流讨论遇到的问题和心得体会。他们的建议和见解对我帮助很大，让我能够更快地找到解决问题的方法。

通过这次实验，我学到了很多宝贵的知识和技能：

- **数值求解ODE的经验**：我掌握了如何使用Python中的`scipy.integrate.odeint`函数来求解微分方程组，并了解了如何调整求解器的参数以满足精度要求。
- **混沌系统特性的理解**：我深刻认识到混沌系统对初始条件的敏感性以及其内在的复杂性和不可预测性。
- **能量分析的重要性**：我意识到在研究物理系统时，能量分析是一个非常有用的工具，它可以帮助我们理解系统的行为和稳定性。
### 4.3 主要收获
（用3-5句话总结你从这个项目中学到的最重要的东西。）
- 加深了对混沌系统特性的理解。
- 掌握了数值求解ODE的经验和方法。
- 认识到了能量分析在研究物理系统中的重要性。

## 5. 思考题（可选）

1.  如果双摆的两个摆臂长度不同（ $L_1 \neq L_2$）或两个摆锤质量不同（ $m_1 \neq m_2$），运动方程会如何变化？你将如何修改你的 `derivatives` 函数来适应这种情况？（提示：需要回顾拉格朗日方程的推导或查找更通用的双摆方程。）- 如果双摆的两个摆臂长度不同（L1≠L2）或两个摆锤质量不同（m1≠m2），运动方程会如何变化？需要回顾拉格朗日方程的推导或查找更通用的双摆方程来修改`derivatives`函数。
2.  双摆的运动对初始条件高度敏感。尝试稍微改变初始角度（例如，将 $\theta_1$ 或 $\theta_2$ 改变 $0.001$ 弧度），重新运行仿真，并比较两个轨迹（例如，绘制 $\theta_1(t)$ 的对比图）。你观察到了什么现象？这与混沌理论有什么关系？
### 观察与分析

通过对比两个轨迹，我们可以观察到以下现象：

- **敏感性**：尽管只是将θ1的初始值增加了0.001弧度，但随着时间的推移，两个轨迹之间的差异逐渐增大。这表明双摆系统对初始条件的高度敏感性。
- **混沌行为**：两个轨迹都没有显示出明显的周期性，而是呈现出复杂的、看似随机的运动模式。这进一步证实了双摆系统的混沌特性。

### 与混沌理论的关系

这个实验结果与混沌理论密切相关。混沌理论指出，在确定性系统中，如果系统具有非线性特性，那么即使初始条件只有微小的差异，随着时间的推移，两个系统的轨迹也会表现出显著的不同。这种现象被称为“蝴蝶效应”。

在我们的实验中，由于双摆系统的非线性特性，以及我们对初始条件的微小修改，导致了两个轨迹之间的显著差异。这正好验证了混沌理论的核心观点之一。
---

_报告长度建议：500-1000字（不含代码和图片），重点关注对物理模型、数值方法和结果分析的理解与反思。_
